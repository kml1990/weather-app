(this["webpackJsonpweather-app"]=this["webpackJsonpweather-app"]||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){"use strict";n.r(t);var a,r,c,o,i,s,u,l=n(0),f=n.n(l),m=n(13),d=n.n(m),_=(n(43),Object(l.createContext)(null)),E=function(e){var t=e.children,n=e.container;return f.a.createElement(_.Provider,{value:n},t)},p=n(18),O=n.n(p),y=n(36),h=n(1),v=n(2),F=n(3),b=n(15),S=n.n(b),j={api:{API_KEY_PARAM:"appid",API_KEY_VALUE:"4b759b7f086ae2b5e17ed220a9b48912",BASE_URL:"https://api.openweathermap.org/data/2.5/onecall",IMAGE_BASE_URL:"https://openweathermap.org/img/wn/"},timing:{ONE_SECOND_IN_MS:1e3,WEATHER_RELOAD_FREQUENCY_IN_MS:6e4,TEMPERATURE_COUNT_UP_SPEED_IN_MS:60,CSS_TRANSITION_DELAY:500},texts:{UNABLE_TO_LOAD_APP:"Something went wrong. Error: ",CONDITION_IMAGE_ALT_TEXT:"Weather Icon",ERROR_LOADING_FORECAST:"Unable to load forecast. Error: "},location:{DEFAULT_LOCATION:"London",LONDON_CORDS:{lat:51.51,lon:-.13}},temperature:{DEFAULT_UNITS:"metric",CELCIUS_SYMBOL:"\u2103",DEFAULT_TEMPERATURE:0},progress:{PROGRESS_MESSAGE:"Reloading in",PROGRESS_UNIT:"s"},misc:{ROOT_ID:"root",DEFAULT_DAILY_FORECAST:[],ICON_EXT:".png"}},N=Object(F.injectable)()(a=function(){function e(){Object(h.a)(this,e)}return Object(v.a)(e,[{key:"fetchForecast",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j.temperature.DEFAULT_UNITS,n=e.lat,a=e.lon;return S.a.get(j.api.BASE_URL,{params:{lat:n,lon:a,units:t}}).then((function(e){return e.data})).catch((function(){}))}}]),e}())||a,g=n(7),A=function(){function e(t){Object(h.a)(this,e),this._day=void 0,this._temperature=void 0,this._condition=void 0,this._icon=void 0;var n=t.day,a=t.temperature,r=t.condition,c=t.icon;this._day=n,this._temperature=a,this._condition=r,this._icon=c}return Object(v.a)(e,[{key:"day",get:function(){return this._day}},{key:"temperature",get:function(){return this._temperature}},{key:"condition",get:function(){return this._condition}},{key:"icon",get:function(){return this._icon}}]),e}(),T=n(12),L=n.n(T),D=Object(F.injectable)()(r=function(){function e(){Object(h.a)(this,e)}return Object(v.a)(e,[{key:"getDateFromEpoch",value:function(e){return L.a.unix(e)}},{key:"isCurrentDay",value:function(e){return L()(e).isSame(new Date,"day")}},{key:"extractDayFromDate",value:function(e){return L()(e).format("ddd")}}]),e}())||r,R={ForecastService:Symbol.for("ForecastService"),LocationService:Symbol.for("LocationService"),ForecastApi:Symbol.for("ForecastApi"),ForecastFactory:Symbol.for("ForecastFactory"),LocationFactory:Symbol.for("LocationFactory"),DailyForecastFactory:Symbol.for("DailyForecastFactory"),DateUtil:Symbol.for("DateUtil")},I=Object(F.injectable)()(c=function(e,t){return Object(F.inject)(R.DateUtil)(e,void 0,0)}(c=Reflect.metadata("design:type",Function)(c=Reflect.metadata("design:paramtypes",["undefined"===typeof D?Object:D])(c=function(){function e(t){Object(h.a)(this,e),this.dateUtil=void 0,this.dateUtil=t}return Object(v.a)(e,[{key:"create",value:function(e){var t=this;return e.daily.reduce((function(e,n){var a=n.dt,r=n.temp.day,c=Object(g.a)(n.weather,1)[0],o=c.description,i=c.icon,s=t.dateUtil.getDateFromEpoch(a),u=t.dateUtil.isCurrentDay(s);if(e.length<5&&!u){var l=t.dateUtil.extractDayFromDate(s),f=Math.floor(r),m=new A({day:l,temperature:f,condition:o,icon:i});e.push(m)}return e}),[])}}]),e}())||c)||c)||c)||c,C=function(){function e(t){Object(h.a)(this,e),this._lat=void 0,this._lon=void 0;var n=t.lat,a=t.lon;this._lat=n,this._lon=a}return Object(v.a)(e,[{key:"lat",get:function(){return this._lat}},{key:"lon",get:function(){return this._lon}}]),e}(),U=Object(F.injectable)()(o=function(){function e(){Object(h.a)(this,e)}return Object(v.a)(e,[{key:"create",value:function(e){var t=e.lat,n=e.lon;return new C({lat:t,lon:n})}}]),e}())||o,P={currentTemperature:0,dailyForecasts:[],location:new C(j.location.LONDON_CORDS)},k=function(){function e(t){Object(h.a)(this,e),this._currentTemperature=void 0,this._dailyForecasts=void 0,this._location=void 0;var n=t.currentTemperature,a=t.dailyForecasts,r=t.location;this._currentTemperature=n,this._dailyForecasts=a,this._location=r}return Object(v.a)(e,[{key:"currentTemperature",get:function(){return this._currentTemperature}},{key:"dailyForecasts",get:function(){return this._dailyForecasts}},{key:"location",get:function(){return this._location}}]),e}(),w=Object(F.injectable)()(i=function(e,t){return Object(F.inject)(R.LocationFactory)(e,void 0,0)}(i=function(e,t){return Object(F.inject)(R.DailyForecastFactory)(e,void 0,1)}(i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",["undefined"===typeof U?Object:U,"undefined"===typeof I?Object:I])(i=function(){function e(t,n){Object(h.a)(this,e),this.locationFactory=void 0,this.dailyForecastFactory=void 0,this.locationFactory=t,this.dailyForecastFactory=n}return Object(v.a)(e,[{key:"create",value:function(e){var t=e.current.temp,n=Math.floor(t),a=this.dailyForecastFactory.create(e),r=this.locationFactory.create(e);return new k({currentTemperature:n,dailyForecasts:a,location:r})}}]),e}())||i)||i)||i)||i)||i,M=Object(F.injectable)()(s=Reflect.metadata("design:type",Function)(s=Reflect.metadata("design:paramtypes",[])(s=function(){function e(){Object(h.a)(this,e),this._currentLocation=void 0,this._currentLocation=new C(j.location.LONDON_CORDS)}return Object(v.a)(e,[{key:"getCurrentLocation",value:function(){return this._currentLocation}},{key:"setCurrentLocation",value:function(e){this._currentLocation=e}}]),e}())||s)||s)||s,x=Object(F.injectable)()(u=function(e,t){return Object(F.inject)(R.ForecastFactory)(e,void 0,0)}(u=function(e,t){return Object(F.inject)(R.LocationService)(e,void 0,1)}(u=function(e,t){return Object(F.inject)(R.ForecastApi)(e,void 0,2)}(u=Reflect.metadata("design:type",Function)(u=Reflect.metadata("design:paramtypes",["undefined"===typeof w?Object:w,"undefined"===typeof M?Object:M,"undefined"===typeof N?Object:N])(u=function(){function e(t,n,a){Object(h.a)(this,e),this.forecastFactory=void 0,this.locationService=void 0,this.forecastApi=void 0,this._forecast=void 0,this.forecastFactory=t,this.locationService=n,this.forecastApi=a,this._forecast=new k(P)}return Object(v.a)(e,[{key:"getForecast",value:function(){var e=this,t=this.locationService.getCurrentLocation();return this.forecastApi.fetchForecast(t).then((function(t){if(!t)return e._forecast;var n=e.forecastFactory.create(t);return e.setForecastLocation(n.location),e._forecast=n,n})).catch((function(){return e._forecast}))}},{key:"setForecastLocation",value:function(e){this.locationService.setCurrentLocation(e)}}]),e}())||u)||u)||u)||u)||u)||u,B=new F.Container,Y=new F.ContainerModule((function(e){e(R.ForecastService).to(x).inSingletonScope(),e(R.LocationService).to(M).inSingletonScope(),e(R.ForecastApi).to(N).inSingletonScope(),e(R.ForecastFactory).to(w).inSingletonScope(),e(R.LocationFactory).to(U).inSingletonScope(),e(R.DailyForecastFactory).to(I).inSingletonScope(),e(R.DateUtil).to(D).inSingletonScope()})),G=function(){function e(){Object(h.a)(this,e)}return Object(v.a)(e,[{key:"loadDependencies",value:function(){var e=Object(y.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B.load(Y),e.abrupt("return",B);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),W=function(){function e(){Object(h.a)(this,e)}return Object(v.a)(e,[{key:"configureApp",value:function(){this.configureAxiosInterceptor()}},{key:"configureAxiosInterceptor",value:function(){S.a.defaults.params={},S.a.interceptors.request.use((function(e){return e.params[j.api.API_KEY_PARAM]=j.api.API_KEY_VALUE,e}),(function(e){return Promise.reject(e)}))}}]),e}(),H=(n(89),f.a.memo((function(e){var t=e.children;return f.a.createElement("div",{className:"Card"},t)})));var K=function(e){var t=e.temperature,n=e.className,a=void 0===n?"":n,r=Object(l.useState)(0),c=Object(g.a)(r,2),o=c[0],i=c[1];Object(l.useEffect)((function(){var e=setTimeout((function(){o<t&&i((function(e){return e+1}))}),j.timing.TEMPERATURE_COUNT_UP_SPEED_IN_MS);return function(){return clearTimeout(e)}})),Object(l.useEffect)((function(){i(0)}),[t]);var s="".concat(o," ").concat(j.temperature.CELCIUS_SYMBOL);return f.a.createElement("span",{className:"Temperature ".concat(a)},s)},X=function(e){var t=e.location,n=e.className,a=void 0===n?"":n;return f.a.createElement("span",{className:"Location ".concat(a)},t)},q=(n(90),function(){var e=Object(l.useState)(),t=Object(g.a)(e,2),n=t[0],a=t[1];return Object(l.useEffect)((function(){var e=L.a.parseZone(L()().format()).format("HH:mm z");a(e)})),f.a.createElement("div",{className:"CurrentTime"},f.a.createElement("span",{className:"CurrentTime__text"},n))}),Q=(n(91),function(e){var t=e.currentTemperature;return f.a.createElement("section",{className:"CurrentForecast"},f.a.createElement(X,{className:"CurrentForecast__location",location:j.location.DEFAULT_LOCATION}),f.a.createElement(q,null),f.a.createElement(K,{className:"CurrentForecast__temperature",temperature:t}))}),J=(n(92),function(e){var t=e.progress,n=e.className,a=void 0===n?"":n;return f.a.createElement("span",{className:"ProgressBar ".concat(a)},f.a.createElement("span",{className:"ProgressBar__rail",style:{width:"".concat(t,"%")}},f.a.createElement("span",{className:"ProgressBar__bar"})))}),V=(n(93),function(e){var t=e.trigger,n=e.reloadFrequencyInSeconds,a=Object(l.useState)(n),r=Object(g.a)(a,2),c=r[0],o=r[1];Object(l.useEffect)((function(){var e=setInterval((function(){o((function(e){return e>0?e-1:0}))}),j.timing.ONE_SECOND_IN_MS);return function(){return clearInterval(e)}}),[]),Object(l.useEffect)((function(){o(n)}),[t]);var i=c/n*100,s="".concat(j.progress.PROGRESS_MESSAGE," ").concat(c).concat(j.progress.PROGRESS_UNIT);return f.a.createElement("section",{className:"ForecastReloadProgress"},f.a.createElement("span",{className:"ForecastReloadProgress__text"},s),f.a.createElement(J,{progress:i,className:"ForecastReloadProgress__bar"}))}),z=n(105),Z=(n(94),function(e){var t=e.condition,n=e.icon,a=e.className,r=void 0===a?"":a,c="".concat(j.api.IMAGE_BASE_URL).concat(n).concat(j.misc.ICON_EXT);return f.a.createElement("div",{className:"WeatherConditions ".concat(r)},f.a.createElement("img",{className:"WeatherConditions__image",src:c,alt:j.texts.CONDITION_IMAGE_ALT_TEXT}),f.a.createElement("span",{className:"WeatherConditions__text"},t))}),$=(n(95),function(e){var t=e.dailyForecast,n=t.day,a=t.temperature,r=t.condition,c=t.icon;return f.a.createElement("li",{className:"DailyForecastItem"},f.a.createElement("span",{className:"DailyForecastItem__day"},n),f.a.createElement(K,{className:"DailyForecastItem__temperature",temperature:a}),f.a.createElement(Z,{className:"DailyForecastItem__condition",condition:r,icon:c}))}),ee=(n(96),function(e){var t=e.dailyForecasts,n=Object(l.useState)(!1),a=Object(g.a)(n,2),r=a[0],c=a[1];Object(l.useEffect)((function(){0!==t.length?c(!0):c(!1)}),[t]);var o=t.map((function(e,t){var n="".concat(e.day,"-").concat(t);return f.a.createElement(z.a,{key:n,in:r,timeout:j.timing.CSS_TRANSITION_DELAY,classNames:"DailyForecastList__item"},f.a.createElement($,{dailyForecast:e}))}));return f.a.createElement("ul",{className:"DailyForecastList"},o)}),te=(n(99),f.a.memo((function(e){var t=e.children;return f.a.createElement("header",{className:"CardHeader"},t)}))),ne=(n(100),f.a.memo((function(e){var t=e.children;return f.a.createElement("main",{className:"CardBody"},t)}))),ae=(n(101),function(){var e=function(e){var t=Object(l.useContext)(_);if(null===t)throw new Error("The dependency container should be defined");return t.get(e)}(R.ForecastService),t=Object(l.useState)(null),n=Object(g.a)(t,2),a=n[0],r=n[1],c=j.timing.WEATHER_RELOAD_FREQUENCY_IN_MS/j.timing.ONE_SECOND_IN_MS,o=function(){e.getForecast().then((function(e){r(e)}))};Object(l.useEffect)((function(){null===a&&o();var e=setInterval((function(){r(null),o()}),j.timing.WEATHER_RELOAD_FREQUENCY_IN_MS);return function(){return clearInterval(e)}}),[]);var i=a&&a.dailyForecasts||j.misc.DEFAULT_DAILY_FORECAST,s=a&&a.currentTemperature||j.temperature.DEFAULT_TEMPERATURE;return f.a.createElement("div",{className:"App"},f.a.createElement(H,null,f.a.createElement(te,null,f.a.createElement(Q,{currentTemperature:s}),f.a.createElement(V,{trigger:a,reloadFrequencyInSeconds:c})),f.a.createElement(ne,null,f.a.createElement(ee,{dailyForecasts:i}))))});n(102);(new G).loadDependencies().then((function(e){(new W).configureApp(),d.a.render(f.a.createElement(E,{container:e},f.a.createElement(ae,null)),document.getElementById(j.misc.ROOT_ID))})).catch((function(e){console.error(j.texts.UNABLE_TO_LOAD_APP,e.message)}))},38:function(e,t,n){e.exports=n(103)},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},99:function(e,t,n){}},[[38,1,2]]]);
//# sourceMappingURL=main.d2228c79.chunk.js.map